% -----------------------
% CUSTOM PREAMBLE STUFF
% -----------------------

% -----------------
% Typography tweaks
% -----------------


% \usepackage{times}
\usepackage{newtxtext}
% \usepackage{newtxmath}

% Indent size
% \setlength{\parindent}1pc0}  % 1p0

% Fix widows and orphans
\usepackage[all,defaultlines=2]{nowidow}

% List things
\usepackage{enumitem}
% Same document-level indentation for ordered and ordered lists
\setlist[1]{labelindent=\parindent}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}

% Wrap definition list terms
% https://tex.stackexchange.com/a/9763/11851
\setlist[description]{style=unboxed}


% For better TOCs
\usepackage{tocloft}

% Remove left margin in lists inside longtables
% https://tex.stackexchange.com/a/378190/11851
\AtBeginEnvironment{longtable}{\setlist[itemize]{nosep, wide=0pt, leftmargin=*, before=\vspace*{-\baselineskip}, after=\vspace*{-\baselineskip}}}


% -----------------
% Title block stuff
% -----------------

% Abstract
\usepackage[overload]{textcase}
\usepackage[original]{abstract}
\renewcommand{\abstractnamefont}{\normalsize\bfseries\MakeUppercase}
\renewcommand{\abstracttextfont}{\normalsize\itshape}
\setlength{\absleftindent}{1.2cm}
\setlength{\absrightindent}{1.2cm}
\abslabeldelim{\\}
\setlength{\abstitleskip}{-\parindent}


% Keywords
\newenvironment{keywords}
{\centering{\normalsize\bfseries\MakeUppercase{Keywords}\itshape}\\}
{\hskip 3em}
% {\vskip -3em \hspace{\parindent}\small{\normalsize\bfseries\MakeUppercase{Keywords}}\quad}
% {\vskip 3em}

  
% Title
\usepackage{titling}
% \setlength{\droptitle}{3em}
\pretitle{\begin{center}\Large\bfseries}
\posttitle{\end{center}}


% Authors
%
% PHEW this is complicated for a number of reasons!
%
% When using \and with multiple authors, the article class in LaTeX wraps each 
% author block in a tabluar environment with a hardcoded center alignment. It's 
% possible to use \preauthor{} to start tabulars with a left alignment {l}, but 
% that only applies to the first author because the others all use \and with the 
% hardcoded {c}. But we can override the \and command and add our own {l}
%
% (See https://github.com/rstudio/rmarkdown/issues/1716#issuecomment-560601691 
% for an example of redefining \and to just be \\)
%
% That's all great, except tabulars have some amount of default horizontal 
% padding, which makes left-aligned author blocks not actuall get fully 
% left-aligned on the page. We can set the horizontal padding for the column to 
% 0, but it requires some wonky syntax: {@{\hspace{0em}}l@{}}
% \renewcommand{\and}{\end{tabular} \hskip 3em \begin{tabular}[t]{@{\hspace{0em}}l@{}}}
% \preauthor{\begin{flushleft}
%            \lineskip 1.5em 
%            \begin{tabular}[t]{@{\hspace{0em}}l@{}}}
% \postauthor{\end{tabular}\par\end{flushleft}}
% \preauthor{\begin{center}}
% \postauthor{\end{center}}


% Omit the date since the \published command does that
\predate{}
\postdate{}

% Command for a note at the top of the first page describing the publication
% status of the paper.
\newcommand{\published}[1]{%
   \gdef\puB{#1}}
   \newcommand{\puB}{}
   \renewcommand{\maketitlehooka}{%
       \par\noindent\footnotesize \puB}


% ------------------
% Section headings
% ------------------
\usepackage{titlesec}
\titleformat*{\section}{\normalsize\bfseries\raggedright}
\titleformat*{\subsection}{\normalsize\bfseries\raggedright}
\titleformat*{\subsubsection}{\normalsize\bfseries\raggedright}
\titleformat*{\paragraph}{\normalsize\bfseries\raggedright}

% \titlespacing{<command>}{<left>}{<before-sep>}{<after-sep>}
% Starred version removes indentation in following paragraph
\titlespacing*{\section}{0em}{2ex}{2ex}
\titlespacing*{\subsection}{0em}{2ex}{2ex}
\titlespacing*{\subsubsection}{0em}{2ex}{2ex}
\titlespacing*{\subsubsubsection}{0em}{2ex}{2ex}

\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}

% -----------
% Footnotes
% -----------
% NB: footmisc has to come after biblatex because of conflicts
\usepackage[bottom, flushmargin]{footmisc}
\renewcommand*{\footnotelayout}{\footnotesize}

\addtolength{\skip\footins}{10pt}    % vertical space between rule and main text
\setlength{\footnotesep}{5pt}  % vertical space between footnotes


% ----------
% Captions
% ----------
\usepackage[font={small,sf}, labelfont={small,sf,bf}]{caption}


% ---------------------------
% END CUSTOM PREAMBLE STUFF
% ---------------------------
